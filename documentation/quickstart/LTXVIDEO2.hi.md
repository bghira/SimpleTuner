# LTX Video 2 рдХреНрд╡рд┐рдХрд╕реНрдЯрд╛рд░реНрдЯ

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо LTXтАС2 video/audio VAE рдФрд░ Gemma3 text encoder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LTX Video 2 LoRA рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд░реЗрдВрдЧреЗред

## рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ

LTX Video 2 рдПрдХ рднрд╛рд░реА **19B** рдореЙрдбрд▓ рд╣реИред рдпрд╣ рдирд┐рдореНрди рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ:
1. **Gemma3**: рдЯреЗрдХреНрд╕реНрдЯ рдПрдиреНрдХреЛрдбрд░ред
2. **LTXтАС2 Video VAE** (audio conditioning рдХреЗ рд▓рд┐рдП Audio VAE рднреА)ред
3. **19B Video Transformer**: рдмрдбрд╝рд╛ DiT backboneред

рдпрд╣ рд╕реЗрдЯрдЕрдк VRAMтАСintensive рд╣реИ, рдФрд░ VAE preтАСcaching рдореЗрдореЛрд░реА usage рдХреЛ spike рдХрд░ рд╕рдХрддрд╛ рд╣реИред

- **SingleтАСGPU рдкреНрд░рд╢рд┐рдХреНрд╖рдг**: `train_batch_size: 1` рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ group offload рд╕рдХреНрд╖рдо рдХрд░реЗрдВред
  - **рдиреЛрдЯ**: рд╢реБрд░реБрдЖрддреА **VAE preтАСcaching рдЪрд░рдг** рдореЗрдВ рдЕрдзрд┐рдХ VRAM рд▓рдЧ рд╕рдХрддреА рд╣реИред caching рдЪрд░рдг рдХреЗ рд▓рд┐рдП CPU offloading рдпрд╛ рдмрдбрд╝рд╛ GPU рдЪрд╛рд╣рд┐рдП рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
  - **рдЯрд┐рдк**: `config.json` рдореЗрдВ `"offload_during_startup": true` рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ VAE рдФрд░ text encoder рдПрдХ рд╕рд╛рде GPU рдкрд░ рд▓реЛрдб рди рд╣реЛрдВ, рдЬрд┐рд╕рд╕реЗ preтАСcaching рдореЗрдореЛрд░реА рджрдмрд╛рд╡ рдХрд╛рдлреА рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред
- **MultiтАСGPU рдкреНрд░рд╢рд┐рдХреНрд╖рдг**: рдпрджрд┐ рдЕрдзрд┐рдХ headroom рдЪрд╛рд╣рд┐рдП рддреЛ **FSDP2** рдпрд╛ рдЖрдХреНрд░рд╛рдордХ **Group Offload** рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред
- **рд╕рд┐рд╕реНрдЯрдо RAM**: рдмрдбрд╝реЗ рд░рди рдХреЗ рд▓рд┐рдП 64GB+ рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ; рдЕрдзрд┐рдХ RAM caching рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред

### рджреЗрдЦреА рдЧрдИ рдкрд░рдлреЙрд░реНрдореЗрдВрд╕ рдФрд░ рдореЗрдореЛрд░реА (рдлреАрд▓реНрдб рд░рд┐рдкреЛрд░реНрдЯ)

- **рдмреЗрд╕рд▓рд╛рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕**: 480p, 17 frames, batch size 2 (рдиреНрдпреВрдирддрдо рд╡реАрдбрд┐рдпреЛ рд▓рдВрдмрд╛рдИ/рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди)ред
- **RamTorch (text encoder рд╕рд╣рд┐рдд)**: AMD 7900XTX рдкрд░ ~13 GB VRAMред
  - NVIDIA 3090/4090/5090+ рдкрд░ рд╕рдорд╛рди рдпрд╛ рдмреЗрд╣рддрд░ VRAM рд╣реЗрдбрд░реВрдо рдорд┐рд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред
- **рдмрд┐рдирд╛ offload (int8 TorchAO)**: ~29-30 GB VRAM; 32 GB рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЕрдиреБрд╢рдВрд╕рд┐рддред
  - рд╕рд┐рд╕реНрдЯрдо RAM рдкреАрдХ: bf16 Gemma3 рд▓реЛрдб рдХрд░рдХреЗ int8 рдореЗрдВ рдХреНрд╡рд╛рдВрдЯрд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдкрд░ ~46 GB (~32 GB VRAM)ред
  - рд╕рд┐рд╕реНрдЯрдо RAM рдкреАрдХ: bf16 LTX-2 transformer рд▓реЛрдб рдХрд░рдХреЗ int8 рдореЗрдВ рдХреНрд╡рд╛рдВрдЯрд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдкрд░ ~34 GB (~30 GB VRAM)ред
- **рдмрд┐рдирд╛ offload (рдкреВрд░реНрдг bf16)**: рдмрд┐рдирд╛ рдХрд┐рд╕реА offload рдХреЗ рдЯреНрд░реЗрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП ~48 GB VRAM рдЪрд╛рд╣рд┐рдПред
- **рдереНрд░реВрдкреБрдЯ**:
  - A100-80G SXM4 рдкрд░ ~8 sec/step (рдХрдореНрдкрд╛рдЗрд▓ рдмрдВрдж)ред
  - 7900XTX рдкрд░ ~16 sec/step (рд▓реЛрдХрд▓ рд░рди)ред
  - A100-80G SXM4 рдкрд░ 200 steps ~30 рдорд┐рдирдЯред

### рдореЗрдореЛрд░реА рдСрдлрд╝рд▓реЛрдбрд┐рдВрдЧ (рдорд╣рддреНрд╡рдкреВрд░реНрдг)

рдЕрдзрд┐рдХрд╛рдВрд╢ singleтАСGPU рд╕реЗрдЯрдЕрдк рдкрд░ LTX Video 2 рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП grouped offloading рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдмрдбрд╝реЗ batch/resolution рдХреЗ рд▓рд┐рдП VRAM headroom рд░рдЦрдиреЗ рд╣реЗрддреБ рдпрд╣ рд╡реИрдХрд▓реНрдкрд┐рдХ рд▓реЗрдХрд┐рди рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред

рдЗрд╕реЗ рдЕрдкрдиреЗ `config.json` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:

<details>
<summary>рдЙрджрд╛рд╣рд░рдг рдХреЙрдиреНрдлрд╝рд┐рдЧ рджреЗрдЦреЗрдВ</summary>

```json
{
  "enable_group_offload": true,
  "group_offload_type": "block_level",
  "group_offload_blocks_per_group": 1,
  "group_offload_use_stream": true
}
```
</details>

## рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдБ

Python 3.12 рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВред

```bash
python --version
```

## рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

```bash
pip install 'simpletuner[cuda]'

# CUDA 13 / Blackwell users (NVIDIA B-series GPUs)
pip install 'simpletuner[cuda13]'
```

рдЕрдзрд┐рдХ рдЙрдиреНрдирдд рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рд▓рд┐рдП [INSTALL.md](../INSTALL.md) рджреЗрдЦреЗрдВред

## рд╡рд╛рддрд╛рд╡рд░рдг рд╕реЗрдЯрдЕрдк

### Web interface

```bash
simpletuner server
```
http://localhost:8001 рдкрд░ рдкрд╣реБрдБрдЪреЗрдВред

### Manual configuration

рд╣реЗрд▓реНрдкрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдБ:

```bash
simpletuner configure
```

рдпрд╛ рдЙрджрд╛рд╣рд░рдг рдХреЙрдкреА рдХрд░рдХреЗ рдореИрдиреНрдпреБрдЕрд▓реА рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:

```bash
cp config/config.json.example config/config.json
```

#### Configuration parameters

LTX Video 2 рдХреЗ рд▓рд┐рдП key settings:

- `model_family`: `ltxvideo2`
- `model_flavour`: `dev` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ), `dev-fp4` рдпрд╛ `dev-fp8`ред
- `pretrained_model_name_or_path`: `Lightricks/LTX-2` (combined checkpoint рд╡рд╛рд▓рд╛ repo) рдпрд╛ local `.safetensors` рдлрд╝рд╛рдЗрд▓ред
- `train_batch_size`: `1`ред рдЗрд╕реЗ рддрдм рддрдХ рди рдмрдврд╝рд╛рдПрдБ рдЬрдм рддрдХ рдЖрдкрдХреЗ рдкрд╛рд╕ A100/H100 рди рд╣реЛред
- `validation_resolution`:
  - `512x768` рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИред
  - `720x1280` (720p) рд╕рдВрднрд╡ рд╣реИ рд▓реЗрдХрд┐рди рднрд╛рд░реА рд╣реИред
- `validation_num_video_frames`: **VAE compression (4x) рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред**
  - 5s (рд▓рдЧрднрдЧ 12тАС24fps рдкрд░): `61` рдпрд╛ `49` рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
  - рд╕реВрддреНрд░: `(frames - 1) % 4 == 0`.
- `validation_guidance`: `5.0`.
- `frame_rate`: рдбрд┐рдлрд╝реЙрд▓реНрдЯ 25 рд╣реИред

LTX-2 рдПрдХ `.safetensors` checkpoint рдХреЗ рд░реВрдк рдореЗрдВ рдЖрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ transformer, video VAE, audio VAE, рдФрд░ vocoder рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
SimpleTuner рдЗрд╕реЗ `model_flavour` (dev/dev-fp4/dev-fp8) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрд╕реА combined рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

### рд╡реИрдХрд▓реНрдкрд┐рдХ: VRAM рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝реЗрд╢рди

VRAM headroom рдЪрд╛рд╣рд┐рдП рддреЛ:
- **Musubi block swap**: `musubi_blocks_to_swap` (`4-8` рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ) рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ `musubi_block_swap_device` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ `cpu`) рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдЦрд╝рд┐рд░реА Transformer blocks CPU рд╕реЗ рд╕реНрдЯреНрд░реАрдо рд╣реЛрдВред throughput рдШрдЯреЗрдЧрд╛ рд▓реЗрдХрд┐рди peak VRAM рдХрдо рд╣реЛрдЧрд╛ред
- **VAE patch convolution**: `--vae_enable_patch_conv=true` рд╕реЗ LTX-2 VAE рдореЗрдВ temporal chunking рд╕рдХреНрд╖рдо рдХрд░реЗрдВ; рдереЛрдбрд╝реА speed рдХрдо рд╣реЛрдЧреА рд▓реЗрдХрд┐рди peak VRAM рдШрдЯреЗрдЧрд╛ред
- **VAE temporal roll**: `--vae_enable_temporal_roll=true` рд╕реЗ рдЕрдзрд┐рдХ aggressive temporal chunking (рдЕрдзрд┐рдХ speed hit)ред
- **VAE tiling**: `--vae_enable_tiling=true` рд╕реЗ рдмрдбрд╝реЗ resolution рдкрд░ VAE encode/decode рдХреЛ tiles рдореЗрдВ рдЪрд▓рд╛рдПрдБред

### рд╡реИрдХрд▓реНрдкрд┐рдХ: CREPA temporal regularizer

flicker рдХрдо рдХрд░рдиреЗ рдФрд░ рдлреНрд░реЗрдореНрд╕ рдореЗрдВ рд╡рд┐рд╖рдп рд╕реНрдерд┐рд░ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП:
- **Training тЖТ Loss functions** рдореЗрдВ **CREPA** рд╕рдХреНрд╖рдо рдХрд░реЗрдВред
- рдЕрдиреБрд╢рдВрд╕рд┐рдд рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдорд╛рди: **Block Index = 8**, **Weight = 0.5**, **Adjacent Distance = 1**, **Temporal Decay = 1.0**.
- рдЬрдм рддрдХ рдЫреЛрдЯрд╛ encoder рди рдЪрд╛рд╣рд┐рдП, рдбрд┐рдлрд╝реЙрд▓реНрдЯ vision encoder (`dinov2_vitg14`, size `518`) рд░рдЦреЗрдВ (`dinov2_vits14` + `224` рдЫреЛрдЯрд╛ рд╡рд┐рдХрд▓реНрдк рд╣реИ)ред
- рдкрд╣рд▓реА рдмрд╛рд░ DINOv2 weights рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП network (рдпрд╛ cached torch hub) рдЪрд╛рд╣рд┐рдПред
- **Drop VAE Encoder** рдХреЗрд╡рд▓ рддрдм рд╕рдХреНрд╖рдо рдХрд░реЗрдВ рдЬрдм рдЖрдк рдкреВрд░реА рддрд░рд╣ cached latents рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реЛрдВ; рдЕрдиреНрдпрдерд╛ рдмрдВрдж рд░рдЦреЗрдВред

### рдЙрдиреНрдирдд рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

<details>
<summary>рдЙрдиреНрдирдд рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрд╛рдПрдБ</summary>


SimpleTuner рдореЗрдВ рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рдлреАрдЪрд░реНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреА рд╕реНрдерд┐рд░рддрд╛ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХрд╛рдлреА рдмреЗрд╣рддрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

*   **[Scheduled Sampling (Rollout)](../experimental/SCHEDULED_SAMPLING.md):** exposure bias рдХрдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдЧреБрдгрд╡рддреНрддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдореЙрдбрд▓ рдХреЛ рдЕрдкрдиреЗ рдЗрдирдкреБрдЯреНрд╕ рдЦреБрдж рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИред

> тЪая╕П рдпреЗ рдлреАрдЪрд░реНрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдХрдВрдкреНрдпреВрдЯреЗрд╢рдирд▓ рдУрд╡рд░рд╣реЗрдб рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред

#### рдбреЗрдЯрд╛рд╕реЗрдЯ рд╡рд┐рдЪрд╛рд░

рд╡реАрдбрд┐рдпреЛ рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рд╕реЗрдЯрдЕрдк рдЪрд╛рд╣рд┐рдПред `config/multidatabackend.json` рдмрдирд╛рдПрдБ:

```json
[
  {
    "id": "my-video-dataset",
    "type": "local",
    "dataset_type": "video",
    "instance_data_dir": "datasets/videos",
    "caption_strategy": "textfile",
    "resolution": 512,
    "video": {
        "num_frames": 61,
        "min_frames": 61,
        "frame_rate": 25,
        "bucket_strategy": "aspect_ratio"
    },
    "audio": {
        "auto_split": true,
        "sample_rate": 16000,
        "channels": 1,
        "duration_interval": 3.0
    },
    "repeats": 10
  },
  {
    "id": "text-embeds",
    "type": "local",
    "dataset_type": "text_embeds",
    "default": true,
    "cache_dir": "cache/text/ltxvideo2",
    "disabled": false
  }
]
```

`video` рдЙрдктАСрд╕реЗрдХреНрд╢рди рдореЗрдВ:
- `num_frames`: рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП target рдлреНрд░реЗрдо рдХрд╛рдЙрдВрдЯред
- `min_frames`: рдиреНрдпреВрдирддрдо рд╡реАрдбрд┐рдпреЛ рд▓рдВрдмрд╛рдИ (рдЫреЛрдЯреЗ рд╡реАрдбрд┐рдпреЛ discard рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ)ред
- `max_frames`: рдЕрдзрд┐рдХрддрдо рд╡реАрдбрд┐рдпреЛ рд▓рдВрдмрд╛рдИ рдлрд╝рд┐рд▓реНрдЯрд░ред
- `bucket_strategy`: videos рдХреЛ buckets рдореЗрдВ рд╕рдореВрд╣рд┐рдд рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛:
  - `aspect_ratio` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ): рдХреЗрд╡рд▓ spatial aspect ratio рд╕реЗ рд╕рдореВрд╣рд┐рддред
  - `resolution_frames`: mixed resolution/duration datasets рдХреЗ рд▓рд┐рдП `WxH@F` рдлреЙрд░реНрдореИрдЯ (рдЬреИрд╕реЗ `1920x1080@61`) рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рдореВрд╣рд┐рддред
- `frame_interval`: `resolution_frames` рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдлреНрд░реЗрдо рдХрд╛рдЙрдВрдЯ рдХреЛ рдЗрд╕ рдЗрдВрдЯрд░рд╡рд▓ рддрдХ рд░рд╛рдЙрдВрдб рдХрд░реЗрдВред

Audio auto-split video datasets рдХреЗ рд▓рд┐рдП default рд░реВрдк рд╕реЗ enabled рд╣реИред Sample rate/channels рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП `audio` block рдЬреЛрдбрд╝реЗрдВ,
`audio.auto_split: false` рдХрд░рдХреЗ opt-out рдХрд░реЗрдВ, рдпрд╛ рдЕрд▓рдЧ audio dataset рджреЗрдХрд░ рдЙрд╕реЗ `s2v_datasets` рд╕реЗ рд▓рд┐рдВрдХ рдХрд░реЗрдВред SimpleTuner
audio latents рдХреЛ video latents рдХреЗ рд╕рд╛рде cache рдХрд░реЗрдЧрд╛ред

> `caption_strategy` рд╡рд┐рдХрд▓реНрдк рдФрд░ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП [DATALOADER.md](../DATALOADER.md#caption_strategy) рджреЗрдЦреЗрдВред

#### Directory setup

```bash
mkdir -p datasets/videos
</details>

# Place .mp4 / .mov files here.
# Place corresponding .txt files with same filename for captions.
```

#### Login

```bash
wandb login
huggingface-cli login
```

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд▓рд╛рдирд╛

```bash
simpletuner train
```

## рдиреЛрдЯреНрд╕ рдФрд░ рд╕рдорд╕реНрдпрд╛тАСрд╕рдорд╛рдзрд╛рди рдЯрд┐рдкреНрд╕

### Out of Memory (OOM)

рд╡реАрдбрд┐рдпреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдмреЗрд╣рдж рдорд╛рдВрдЧ рд╡рд╛рд▓рд╛ рд╣реИред рдпрджрд┐ OOM рд╣реЛ:

1. **Resolution рдШрдЯрд╛рдПрдБ**: 480p (рдЬреИрд╕реЗ `480x854`) рдЖрдЬрд╝рдорд╛рдПрдБред
2. **Frames рдШрдЯрд╛рдПрдБ**: `validation_num_video_frames` рдФрд░ dataset `num_frames` рдХреЛ `33` рдпрд╛ `49` рддрдХ рдШрдЯрд╛рдПрдБред
3. **Offload рдЬрд╛рдВрдЪреЗрдВ**: рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ `--enable_group_offload` рд╕рдХреНрд░рд┐рдп рд╣реИред

### Validation Video Quality

- **Black/Noise Videos**: рдЕрдХреНрд╕рд░ `validation_guidance` рдмрд╣реБрдд рдЕрдзрд┐рдХ (> 6.0) рдпрд╛ рдмрд╣реБрдд рдХрдо (< 2.0) рд╣реЛрдиреЗ рд╕реЗ рд╣реЛрддрд╛ рд╣реИред `5.0` рдкрд░ рд░рд╣реЗрдВред
- **Motion Jitter**: рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ dataset frame rate рдореЙрдбрд▓ рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд frame rate (рдЕрдХреНрд╕рд░ 25fps) рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
- **Stagnant/Static Video**: рдореЙрдбрд▓ рдХрдо рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ prompt рдореЗрдВ motion рд╡рд░реНрдгрди рдирд╣реАрдВ рд╣реИред "camera pans right", "zoom in", "running" рдЬреИрд╕реЗ prompts рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

### TREAD рдкреНрд░рд╢рд┐рдХреНрд╖рдг

TREAD рд╡реАрдбрд┐рдпреЛ рдХреЗ рд▓рд┐рдП рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ compute рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрддреНрдпрдзрд┐рдХ рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред

`config.json` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:

<details>
<summary>рдЙрджрд╛рд╣рд░рдг рдХреЙрдиреНрдлрд╝рд┐рдЧ рджреЗрдЦреЗрдВ</summary>

```json
{
  "tread_config": {
    "routes": [
      {
        "selection_ratio": 0.5,
        "start_layer_idx": 2,
        "end_layer_idx": -2
      }
    ]
  }
}
```
</details>

ratio рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реБрдП рдпрд╣ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ ~25тАС40% рддрдХ рддреЗрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдиреНрдпреВрдирддрдо VRAM рдЙрдкрдпреЛрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧ (7900XTX)

LTX Video 2 рдкрд░ рдиреНрдпреВрдирддрдо VRAM рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдлреАрд▓реНрдбтАСрдЯреЗрд╕реНрдЯреЗрдб рдХреЙрдиреНрдлрд╝рд┐рдЧред

<details>
<summary>7900XTX рдХреЙрдиреНрдлрд╝рд┐рдЧ рджреЗрдЦреЗрдВ (рдиреНрдпреВрдирддрдо VRAM рдЙрдкрдпреЛрдЧ)</summary>

```json
{
  "base_model_precision": "int8-quanto",
  "checkpoint_step_interval": 100,
  "data_backend_config": "config/ltx2/multidatabackend.json",
  "disable_benchmark": true,
  "dynamo_mode": "",
  "evaluation_type": "none",
  "hub_model_id": "simpletuner-ltxvideo2-19b-t2v-lora-test",
  "learning_rate": 0.00006,
  "lr_warmup_steps": 50,
  "lycoris_config": "config/lycoris_config.json",
  "max_grad_norm": 0.1,
  "max_train_steps": 200,
  "minimum_image_size": 0,
  "model_family": "ltxvideo2",
  "model_flavour": "dev",
  "model_type": "lora",
  "num_train_epochs": 0,
  "offload_during_startup": true,
  "optimizer": "adamw_bf16",
  "output_dir": "output/examples/ltxvideo2-19b-t2v.peft-lora",
  "override_dataset_config": true,
  "ramtorch": true,
  "ramtorch_text_encoder": true,
  "report_to": "none",
  "resolution": 480,
  "scheduled_sampling_reflexflow": false,
  "seed": 42,
  "skip_file_discovery": "",
  "tracker_project_name": "lora-training",
  "tracker_run_name": "example-training-run",
  "train_batch_size": 2,
  "vae_batch_size": 1,
  "vae_enable_patch_conv": true,
  "vae_enable_slicing": true,
  "vae_enable_temporal_roll": true,
  "vae_enable_tiling": true,
  "validation_disable": true,
  "validation_disable_unconditional": true,
  "validation_guidance": 5,
  "validation_num_inference_steps": 40,
  "validation_num_video_frames": 81,
  "validation_prompt": "ЁЯЯл is holding a sign that says hello world from ltxvideo2",
  "validation_resolution": "768x512",
  "validation_seed": 42,
  "validation_using_datasets": false
}
```
</details>

### рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ

LTX-2 **рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ** рдХреЛ рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд╣рд╛рдБ рдЖрдк рдмрд┐рдирд╛ рд╡реАрдбрд┐рдпреЛ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдЬреЗрдирд░реЗрд╢рди рдХреНрд╖рдорддрд╛ рдХреЛ рдЯреНрд░реЗрди рдХрд░рддреЗ рд╣реИрдВред рдпрд╣ рддрдм рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдСрдбрд┐рдпреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рд╣реИрдВ рд▓реЗрдХрд┐рди рдХреЛрдИ рд╕рдВрдмрдВрдзрд┐рдд рд╡реАрдбрд┐рдпреЛ рдХрдВрдЯреЗрдВрдЯ рдирд╣реАрдВ рд╣реИред

рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдореЛрдб рдореЗрдВ:
- рд╡реАрдбрд┐рдпреЛ latents рдЕрдкрдиреЗ рдЖрдк рд╢реВрдиреНрдп рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ (рдореЗрдореЛрд░реА рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдиреНрдпреВрдирддрдо 64x64 рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди)
- рд╡реАрдбрд┐рдпреЛ loss рдорд╛рд╕реНрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ (рдЧрдгрдирд╛ рдирд╣реАрдВ рд╣реЛрддреА)
- рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдЬреЗрдирд░реЗрд╢рди рд▓реЗрдпрд░реНрд╕ рдЯреНрд░реЗрди рд╣реЛрддреА рд╣реИрдВ

рдЬрдм рдЖрдкрдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рд╣реЛрддреЗ рд╣реИрдВ (рдХреЛрдИ рд╡реАрдбрд┐рдпреЛ рдпрд╛ рдЗрдореЗрдЬ рдбреЗрдЯрд╛рд╕реЗрдЯ рдирд╣реАрдВ), рддреЛ рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдореЛрдб **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдбрд┐рдЯреЗрдХреНрдЯ** рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдк `audio.audio_only: true` рд╕реЗ рднреА рдЗрд╕реЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

```json
[
  {
    "id": "my-audio-dataset",
    "type": "local",
    "dataset_type": "audio",
    "instance_data_dir": "datasets/audio",
    "caption_strategy": "textfile",
    "audio": {
      "sample_rate": 16000,
      "channels": 2,
      "duration_interval": 3.0,
      "truncation_mode": "beginning"
    },
    "repeats": 10
  },
  {
    "id": "text-embeds",
    "type": "local",
    "dataset_type": "text_embeds",
    "default": true,
    "cache_dir": "cache/text/ltxvideo2",
    "disabled": false
  }
]
```

рдореБрдЦреНрдп рдСрдбрд┐рдпреЛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕:
- `channels`: LTX-2 Audio VAE рдХреЗ рд▓рд┐рдП **2 (рд╕реНрдЯреАрд░рд┐рдпреЛ) рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП**
- `duration_interval`: рдСрдбрд┐рдпреЛ рдХреЛ рдЗрдВрдЯрд░рд╡рд▓ рдореЗрдВ рдмрдХреЗрдЯ рдХрд░реЗрдВ (рдЬреИрд╕реЗ 3.0 рд╕реЗрдХрдВрдб)ред **рдореЗрдореЛрд░реА рдореИрдиреЗрдЬрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг** - рд▓рдВрдмреА рдСрдбрд┐рдпреЛ рдлрд╛рдЗрд▓реЗрдВ рдХрдИ рд╡реАрдбрд┐рдпреЛ рдлреНрд░реЗрдо рдмрдирд╛рддреА рд╣реИрдВ рднрд▓реЗ рд╣реА рд╡реЗ рд╢реВрдиреНрдп рд╣реЛрдВ
- `truncation_mode`: рдмрдХреЗрдЯ duration рд╕реЗ рдЕрдзрд┐рдХ рдСрдбрд┐рдпреЛ рдХреЛ рдХреИрд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░реЗрдВ (`beginning`, `end`, рдпрд╛ `random`)

#### рд╕рдорд░реНрдерд┐рдд рдСрдбрд┐рдпреЛ рдлреЙрд░реНрдореЗрдЯ

SimpleTuner рд╕рд╛рдорд╛рдиреНрдп рдСрдбрд┐рдпреЛ рдлреЙрд░реНрдореЗрдЯ (`.wav`, `.flac`, `.mp3`, `.ogg`, `.opus`, рдЖрджрд┐) рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдХрдВрдЯреЗрдирд░ рдлреЙрд░реНрдореЗрдЯ рдЬрд┐рдирдореЗрдВ рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (`.mp4`, `.mpeg`, `.mkv`, `.webm`) рдХреЛ рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИред рдХрдВрдЯреЗрдирд░ рдлреЙрд░реНрдореЗрдЯ ffmpeg рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХреНрд╕рдЯреНрд░реИрдХреНрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

#### рдСрдбрд┐рдпреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП LoRA рдЯрд╛рд░рдЧреЗрдЯ

рдЬрдм рдЖрдкрдХреЗ datasets рдореЗрдВ рдСрдбрд┐рдпреЛ рдбреЗрдЯрд╛ рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, SimpleTuner рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдСрдбрд┐рдпреЛ-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдХреЛ LoRA рдЯрд╛рд░рдЧреЗрдЯ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ:
- `audio_proj_in` - рдСрдбрд┐рдпреЛ рдЗрдирдкреБрдЯ рдкреНрд░реЛрдЬреЗрдХреНрд╢рди
- `audio_proj_out` - рдСрдбрд┐рдпреЛ рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░реЛрдЬреЗрдХреНрд╢рди
- `audio_caption_projection.linear_1` - рдСрдбрд┐рдпреЛ рдХреИрдкреНрд╢рди рдкреНрд░реЛрдЬреЗрдХреНрд╢рди рд▓реЗрдпрд░ 1
- `audio_caption_projection.linear_2` - рдСрдбрд┐рдпреЛ рдХреИрдкреНрд╢рди рдкреНрд░реЛрдЬреЗрдХреНрд╢рди рд▓реЗрдпрд░ 2

рдпрд╣ рдХреЗрд╡рд▓ рдСрдбрд┐рдпреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рдФрд░ рд╕рдВрдпреБрдХреНрдд рдСрдбрд┐рдпреЛ+рд╡реАрдбрд┐рдпреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╣реЛрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк LoRA рдЯрд╛рд░рдЧреЗрдЯ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ `--peft_lora_target_modules` рдХреЗ рд╕рд╛рде рдореЙрдбреНрдпреВрд▓ рдирд╛рдореЛрдВ рдХреА JSON рд▓рд┐рд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

рдЕрдкрдиреА рдСрдбрд┐рдпреЛ рдлрд╛рдЗрд▓реЗрдВ `instance_data_dir` рдореЗрдВ рд░рдЦреЗрдВ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд `.txt` рдХреИрдкреНрд╢рди рдлрд╛рдЗрд▓реЗрдВ рдкреНрд░рджрд╛рди рдХрд░реЗрдВред

### Validation workflows (T2V vs I2V)

- **T2V (textтАСtoтАСvideo)**: `validation_using_datasets: false` рд░рдЦреЗрдВ рдФрд░ `validation_prompt` рдпрд╛ `validation_prompt_library` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
- **I2V (imageтАСtoтАСvideo)**: `validation_using_datasets: true` рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ `eval_dataset_id` рдХреЛ рдРрд╕реЗ validation split рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░реЗрдВ рдЬреЛ reference image рджреЗрддрд╛ рд╣реЛред Validation imageтАСtoтАСvideo pipeline рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрд╕реА image рдХреЛ conditioning рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред
- **S2V (audioтАСconditioned)**: `validation_using_datasets: true` рдХреЗ рд╕рд╛рде, `eval_dataset_id` рдХреЛ `s2v_datasets` (рдпрд╛ default `audio.auto_split`) рд╡рд╛рд▓реЗ dataset рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред Validation cached audio latents рдЕрдкрдиреЗтАСрдЖрдк рд▓реЛрдб рдХрд░реЗрдЧрд╛ред

### Validation adapters (LoRAs)

Lightricks рдХреЗ LoRAs рдХреЛ validation рдореЗрдВ `validation_adapter_path` (single) рдпрд╛ `validation_adapter_config` (multiple runs) рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди repos рдореЗрдВ nonstandard weight filename рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП `repo_id:weight_name` рдХреЗ рд╕рд╛рде рджреЗрдВред рд╕рд╣реА filenames рдФрд░ assets рдХреЗ рд▓рд┐рдП LTX-2 collection рджреЗрдЦреЗрдВ:
https://huggingface.co/collections/Lightricks/ltx-2
- `Lightricks/LTX-2-19b-IC-LoRA-Canny-Control:ltx-2-19b-ic-lora-canny-control.safetensors`
- `Lightricks/LTX-2-19b-IC-LoRA-Depth-Control:ltx-2-19b-ic-lora-depth-control.safetensors`
- `Lightricks/LTX-2-19b-IC-LoRA-Detailer:ltx-2-19b-ic-lora-detailer.safetensors`
- `Lightricks/LTX-2-19b-IC-LoRA-Pose-Control:ltx-2-19b-ic-lora-pose-control.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Dolly-In:ltx-2-19b-lora-camera-control-dolly-in.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Dolly-Out:ltx-2-19b-lora-camera-control-dolly-out.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Dolly-Left:ltx-2-19b-lora-camera-control-dolly-left.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Dolly-Right:ltx-2-19b-lora-camera-control-dolly-right.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Jib-Down:ltx-2-19b-lora-camera-control-jib-down.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Jib-Up:ltx-2-19b-lora-camera-control-jib-up.safetensors`
- `Lightricks/LTX-2-19b-LoRA-Camera-Control-Static:ltx-2-19b-lora-camera-control-static.safetensors`

рддреЗрдЬрд╝ validation рдХреЗ рд▓рд┐рдП `Lightricks/LTX-2-19b-distilled-lora-384:ltx-2-19b-distilled-lora-384.safetensors` рдХреЛ
validation adapter рдХреЗ рд░реВрдк рдореЗрдВ рд▓рдЧрд╛рдПрдВ рдФрд░ `validation_guidance: 1` рддрдерд╛ `validation_num_inference_steps: 8` рд╕реЗрдЯ рдХрд░реЗрдВред
